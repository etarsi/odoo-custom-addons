<odoo>
    <!-- Acción de reporte -->
    <report
        id="report_debt_composition_client_company_pdf"
        model="report.debt.composition.client.company"
        string="Composición de deuda"
        report_type="qweb-pdf"
        name="debt_composition.report_debt_composition_client_pdf_template"
        file="debt_composition.report_debt_composition_client_pdf_template"
    />

    <!-- Plantilla QWeb -->
    <template id="report_debt_composition_client_pdf_template">
        <t t-call="web.external_layout">
            <t t-set="doc" t-value="docs[:1]"/> <!-- por si necesitás datos generales -->
            <div class="page">
                <h2>Composición de deuda - <t t-esc="docs and docs[0].partner.name or ''"/></h2>
                <table class="table table-sm o_main_table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Documento</th>
                            <th>Origen</th>
                            <th>Importe original</th>
                            <th>Aplicado</th>
                            <th>Residual</th>
                            <th>Saldo acumulado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <t t-foreach="docs | groupby('company_id')" t-as="g">
                            <tr>
                                <td colspan="7">
                                    <strong>
                                        Compañía: <t t-esc="g.grouper.name"/>
                                    </strong>
                                </td>
                            </tr>

                            <tr t-foreach="g.list" t-as="l">
                                <td><t t-esc="l.fecha"/></td>
                                <td><t t-esc="l.nombre"/></td>
                                <td><t t-esc="l.origen"/></td>
                                <td class="text-right"><t t-esc="l.importe_original"/></td>
                                <td class="text-right"><t t-esc="l.importe_aplicado"/></td>
                                <td class="text-right"><t t-esc="l.importe_residual"/></td>
                                <td class="text-right"><t t-esc="l.saldo_acumulado"/></td>
                            </tr>
                        </t>
                    </tbody>
                </table>
            </div>
        </t>
    </template>
</odoo>
