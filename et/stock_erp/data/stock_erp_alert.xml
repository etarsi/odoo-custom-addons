<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- Template de mail -->
    <record id="mail_template_stock_erp_below_limit" model="mail.template">
        <field name="name">Stock ERP - Alerta stock bajo</field>
        <field name="model_id" ref="model_stock_erp"/>
        <field name="subject">[ALERTA STOCK] ${object.product_id.display_name} bajo límite</field>
        <field name="body_html" type="html">
            <![CDATA[
            <div>
                <p><b>Alerta de stock</b></p>
                <p>
                    Producto: <b>${object.product_id.display_name}</b><br/>
                    Disponible: <b>${object.disponible_unidades}</b><br/>
                    Límite: <b>${object.stock_limit_unidades}</b>
                </p>
                <p>Registro: ${object.display_name}</p>
            </div>
            ]]>
        </field>
        <field name="auto_delete" eval="True"/>
    </record>

    <!-- Cron: cada 30 min (ajustalo a gusto) -->
    <record id="ir_cron_stock_erp_limit_alerts" model="ir.cron">
        <field name="name">Stock ERP - Alertas por límite</field>
        <field name="model_id" ref="model_stock_erp"/>
        <field name="state">code</field>
        <field name="code">model._cron_stock_limit_alerts()</field>
        <field name="interval_number">30</field>
        <field name="interval_type">minutes</field>
        <field name="numbercall">-1</field>
        <field name="active" eval="True"/>
    </record>

</odoo>