<?xml version="1.0" encoding="utf-8"?>
<odoo>
  <template id="report_invoice_document_inherit_custom"
            inherit_id="l10n_ar_afipws_fe.report_invoice_document">

    <!-- Inserta antes del paginador -->
    <xpath expr="//div[@name='footer_right_column']" position="replace">
        <div name="footer_right_column" class="col-4 text-right">
            <t t-if="o.company_id.id != 1">
              <div>CAE: <span t-field="o.afip_auth_code"/></div>
              <div>CAE Vencimiento: <span t-field="o.afip_auth_code_due"/></div>
            </t>
            <div name="pager" t-if="report_type == 'pdf'">
                Page: <span class="page"/> / <span class="topage"/>
            </div>
        </div>
    </xpath>
  </template>


  <template id="report_custom_header" inherit_id="l10n_ar.custom_header">
    <xpath expr="//div[@class='col-6 text-right']" position="replace">
      <div class="col-6 text-right" style="padding-left: 0px;">

          <t t-if="not pre_printed_report">
              <!-- (7) Numero punto venta - (8) numero de documento -->
              <span t-att-style="'color: %s;' % o.company_id.secondary_color">Nro: </span><span t-esc="report_number"/>
          </t>
          <br/>

          <!-- (9) Fecha -->
          <span t-att-style="'color: %s;' % o.company_id.secondary_color">Date: </span><span t-esc="report_date" t-options='{"widget": "date"}'/>
          <t t-if="o.company_id.id != 1">
            <t t-if="not pre_printed_report">
                <!-- (5) Condicion de IVA / Responsabilidad -->
                <!-- (10) CUIT -->
                <br/>
                <span t-field="o.company_id.l10n_ar_afip_responsibility_type_id"/><span t-att-style="'color: %s;' % o.company_id.secondary_color"> - CUIT: </span><span t-field="o.company_id.partner_id.l10n_ar_formatted_vat"/>

                <!-- (11) IIBB: -->
                <!-- (12) Inicio de actividades -->
                <br/><span t-att-style="'color: %s;' % o.company_id.secondary_color">IIBB: </span><span t-esc="o.company_id.l10n_ar_gross_income_type == 'exempt' and 'Exento' or o.company_id.l10n_ar_gross_income_number"/><span t-att-style="'color: %s;' % o.company_id.secondary_color"> - Activities Start: </span><span t-field="o.company_id.l10n_ar_afip_start_date"/>
            </t>
          </t>
      </div>
    </xpath>
    <xpath expr="//div[@class='row']/div[@class='col-6']" position="replace">
      <div class="col-6" style="padding-right: 0px;">
          <t t-if="not pre_printed_report">
              <!-- (1) Nombre de Fantasia -->
              <!-- (2) Apellido y Nombre o Razon Social -->
              <t t-if="o.company_id.id != 1">
                  <span t-field="o.company_id.partner_id.name"/>
              </t>
              <t else="">
                  <span> </span>
              </t>

              <!-- (3) Domicilio Comercial (Domicilio Fiscal is the same) -->
              <br/>
              <div></div>
              <!-- we dont use the address widget as it adds a new line on the phone and we want to reduce at maximum lines qty -->
              <t t-esc="' - '.join([item for item in [
                  ', '.join([item for item in [header_address.street, header_address.street2] if item]),
                  header_address.city,
                  header_address.state_id and header_address.state_id.name,
                  header_address.zip,
                  header_address.country_id and header_address.country_id.name] if item])"/><span t-if="header_address.phone"> - </span><span t-if="header_address.phone" style="white-space: nowrap;" t-esc="'Tel: ' + header_address.phone"/>
              <br/>
              <span t-att-style="'color: %s;' % o.company_id.primary_color" t-esc="' - '.join([item for item in [(header_address.website or '').replace('https://', '').replace('http://', ''), header_address.email] if item])"/>
          </t>
      </div>
    </xpath>
  </template>
</odoo>
